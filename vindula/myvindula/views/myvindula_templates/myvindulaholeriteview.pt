<html metal:use-macro="here/main_template/macros/master">
	<head>
		<metal:js fill-slot="javascript_head_slot">
    		<script type="text/javascript" src="" tal:attributes="src string:${view/static}/js/ajax_holerite.js"></script>
		</metal:js>
		
		<metal:styleslot fill-slot="style_slot">
    		<link rel="stylesheet" href="" type="text/css" tal:attributes="href string:${view/static}/form_holerite.css">
		</metal:styleslot>
		
	</head>
    <body>
		<metal:block fill-slot="top_slot">
			<tal:dummy tal:define="dummy python:request.set('disable_border',1)" />
		</metal:block>
		
		<div metal:fill-slot="content">         
			<metal:page metal:define-macro="page">
				<script type="text/javascript" src="" tal:attributes="src string:${view/static}/js/ajax_holerite.js"></script>
				<script type="text/javascript" src="" tal:attributes="src string:${view/static}/js/mascara.js"></script>
				<link rel="stylesheet" href="" type="text/css" tal:attributes="href string:${view/static}/form_holerite.css">
				
				<div id="holerite-content" tal:define=" view python:context.restrictedTraverse('@@myvindula-holerite');
														validUser view/validateUser;">
					
					<div metal:use-macro="context/global_statusmessage/macros/portal_message">
				     Status message
				    </div>
					
					<tal:cond condition="not: validUser">
	                    <form action="/@@myvindula-recursos-humanos?id=myvindula-holerite" method="post">
							<h2>Valide seu CPF para acessar o Holerite</h2>
							<div class="marginBtTp10px">
		                        <label>Número do CPF</label>
								<div class="formHelp">Digite o número do seu CPF.</div>
		                        <input type="text" name="cpf_validate" id="cpf_validate" /><br />
								
							</div>
							<div class="bt_comentar">
								<input type="submit" name="submitted_cpf" id="submitted_cpf" value="Validar CPF" />
							</div>
	                    </form>
	                </tal:cond>
					
					<tal:cond condition="validUser">
						<tal:def define="load_list view/load_list|nothing;
										 item load_list/data|nothing;
										 select load_list/select|nothing;">
											  	
	                    	<h2>Demonstrativo de Pagamento de Sal&aacute;rio</h2>
		                    <tal:cond condition="python:item">
		                        <div id="select-holerite">
		                            <h4>Pagamentos anteriores</h4>
		                            <input type="hidden" id="portal_url" tal:attributes="value context/portal_url|nothing"><input type="hidden" id="cpf" tal:attributes="value item/cpf|nothing">
		                            <select id="select-holerite" name="select-holerite">
		                                <option value="">Competência</option>
		                                <tal:rep repeat="opt select">
		                                    <option tal:attributes="value opt/id|nothing" tal:content="opt/competencia|nothing" />
		                                </tal:rep>
		                            </select>
		                        </div>
		                        <br/>
		                        <h4>Ultimo Pagamento</h4>
		                        <!-- Spinner -->
		                        <div id="spinner" class="display-none" style="text-align:center;">
		                            <img src="" alt="spinner" align="center" tal:attributes="src string:${view/static}/ajaxLoader.gif" />
		                        </div>
		                        <div id="holerite-cont" style="width: 660px;">
									<metal:macro define-macro="holerite">
										<div id="holerite">
											<div class="border"  style="width: 660px;">
												<div class="row title even">
													<div class="cell width-full position-0">
														<span >Empresa</span>	
													</div>
												</div>										
												<div class="row">
													<div class="cell width-2 position-0">
														<span tal:content="item/cod_empresa|nothing" />
													</div>
													<div class="cell width-12 position-1">
														<span tal:content="item/empresa|nothing" />
													</div>
													<div class="cell width-2 position-12">
														<span tal:content="item/cidade_empresa|nothing" />
													</div>
												</div>
												<div class="row">
													<div class="cell width-13 position-1">
														<span tal:content="item/endereco_empresa|nothing" />		
													</div>
													<div class="cell width-2 position-14">
														<span tal:content="item/estado_empresa|nothing" />		
													</div>
													
												</div>
												<div class="row">
													<div class="cell width-7 position-1">
														<span tal:content="item/cnpj_empresa|nothing" />		
													</div>
													<div class="cell width-3 position-11">
														<span>Competência</span>
													</div>
													<div class="cell width-2 position-14">
														<span tal:define="comp item/competencia|nothing"
														tal:content="comp" />
													</div>
												</div>
											</div>
											<div class="border"> 
												<div class="row title even" style="width: 660px;">
													<div class="cell width-full position-0">
														<span >Funcionário</span>
													</div>
												</div>
												<div class="row">
													<div class="cell width-2 position-0">
														<span tal:content="item/matricula|nothing" />
													</div>
													<div class="cell width-10 position-2">
														<span tal:content="item/nome|nothing" />
													</div>
													<div class="cell width-4 position-12">
														<span tal:content="string: CPF: ${item/cpf|nothing}" />
													</div>
												</div>
											</div>
											<tal:def define="tmp item/id|nothing;
															 descricoes python:view.get_descricao_holerite(tmp)">
												<div class="row title even">
													<div class="cell width-1 position-0">
														<span>Cód.</span>
													</div>
													<div class="cell width-7 position-1">
														<span>Descri&ccedil;&atilde;o</span>
													</div>
													<div class="cell width-2 position-8">
														<span>Ref.</span>
													</div>
													<div class="cell width-3 position-10">
														<span>Vencimentos</span>
													</div>
													<div class="cell width-2 position-13">
														<span>Descontos</span>
													</div>
												</div> 
												<tal:rep repeat="descricao descricoes">
													<div tal:define="even repeat/descricao/even|nothing" 
														class="row" tal:attributes="class python:even and 'row' or 'row even'">
														<div class="cell width-1 position-0">
															<span tal:content="descricao/codigo|nothing">Cód.</span>
														</div>
														<div class="cell width-7 position-1">
															<span tal:content="descricao/descricao|nothing">Descri&ccedil;&atilde;o</span>
														</div>
														<div class="cell width-2 position-8 center">
															<span tal:content="descricao/ref|nothing">Ref.</span>
														</div>
														<div class="cell width-3 position-10 center">
															<span tal:content="descricao/vencimentos|nothing">Vencimentos</span>
														</div>
														<div class="cell width-2 position-13 center">
															<span tal:content="descricao/descontos|nothing">Descontos</span>
														</div>
													</div> 
												</tal:rep>
											</tal:def>
											<div class="row border">
												<div class="cell width-10 position-0 title" >
													<span>mensagem</span>
													<div class="row">
														<div class="cell width-13 position-0" >
															<span tal:content="item/observacao|nothing">Observações</span>
														</div>	
													</div>
												</div>
												<div class="cell width-6-5 position-10 border-horz even">
													<div class="row">
														<div class="cell width-8 position-0">
															<div class="row title">
																<div class="cell width-full position-0">
																	<span>Total Vencimentos</span>	
																</div>
															</div>
															<div class="row center">
																<div class="cell width-full position-0">
																	<span tal:content="item/total_vencimento|nothing">Total Vencimentos</span>	
																</div>
															</div>
														</div>
														<div class="cell width-8 position-8 border-horz">
															<div class="row title">
																<div class="cell width-full position-0">
																	<span>Total Descontos</span>	
																</div>
															</div>
															<div class="row center">
																<div class="cell width-full position-0">
																	<span tal:content="item/total_desconto|nothing">Total Descontos</span>	
																</div>
															</div>
														</div>
													</div>
													<div class="row border center">
														<div class="cell width-8 position-0">
															<b><span>Valor L&iacute;quido</span></b>
														</div>
														<div class="cell width-8 position-8">
															<b><span tal:content="item/valor_liquido|nothing">Valor L&iacute;quido</span></b>
														</div>
													</div>
												</div>
											</div>
											<div class="row title even">
												<div class="cell width-3 position-0">
													<span>Sal&aacute;rio Base</span>
												</div>
												<div class="cell width-3 position-3">
													<span>Base INSS</span>
												</div>
												<div class="cell width-3 position-6">
													<span>Base FGTS</span>
												</div>
												<div class="cell width-3 position-9">
													<span>FGTS Mês</span>
												</div>
												<div class="cell width-3 position-12">
													<span>Base IRRF</span>
												</div>
											</div>
											<div class="row even center">
												<div class="cell width-3 position-0">
													<span tal:content="item/salario_base|nothing" />
												</div>
												<div class="cell width-3 position-3">
													<span tal:content="item/base_Inss|nothing" />
												</div>
												<div class="cell width-3 position-6">
													<span tal:content="item/base_fgts|nothing" />
												</div>
												<div class="cell width-3 position-9">
													<span tal:content="item/fgts_mes|nothing" />
												</div>
												<div class="cell width-3 position-12">
													<span tal:content="item/base_irrf|nothing" />
												</div>								
											</div>
										</div>
										<div style="width:100%; margin-top: 10px;">
											<input type="button" value="Imprimir" tal:attributes="onclick string:window.open('${context/portal_url}/imprimir-holerite?cpf=${item/cpf|nothing}&id=${item/id|nothing}', 'popupwindow', 'scrollbars=yes,width=670,height=600');;return true;;"/>
										</div>
									</metal:macro>
		                        </div>
		                    </tal:cond>
		                    <tal:cond condition="not: item">
		                        <h3>Voce não possui demonstrativos de pagamento.</h3>
		                    </tal:cond>
						</tal:def>
					</tal:cond>
				</div>
			</metal:page>
		</div>
	</body>
</html>
