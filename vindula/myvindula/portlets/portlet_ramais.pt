<dl class="portlet" tal:define="view view/data">
    <dt class="portletHeader">
        <span class="portletTopLeft"></span>
		<span class="tile" tal:content="view/get_title">Portlet Title</span>
		<span class="portletTopRight"></span>
    </dt>

    <dd class="portletItem odd">

		<div id="busca-portlet">
			<form action="#portlet-ramais" method="post" id="portlet-ramais">
		    	<!--h4>Nome:</h4>
				<input type="text" name="title" size="26" tal:attributes="value python: request.get('title', '')"/>
				<h4>Ramal:</h4>
				<input type="text" name="ramal" size="26" tal:attributes="value python: request.get('ramal', '')"/-->
				
				
				<tal:rep repeat="detail view/get_camposFilter">
                    <h4 tal:condition="python: detail['label'] and detail['content']"
                        tal:content="string: ${detail/label}: "> </h4>
                    <input type="text" name="ramal" size="26"
                           tal:define="campo  detail/content"
                           tal:attributes="value python: request.get(campo, '');
                                           name campo"/>
                </tal:rep>
				
				<h4>Departamento:</h4>
				<tal:def define="filtro view/filtro_departamento|nothing;
								 ctx python:context;
								 uid_selected python: view.get_uid_struct_org(ctx)">
		            <tal:cond condition="python: filtro=='departamentos'">
		            	<select size="1" id="departamento" name="departamento" style="width:100%;">
			        		<option value="" >Todos ...</option>
				            <tal:departamentos tal:repeat="item view/list_departamentos">
			            		<tal:cond condition="request/SearchSubmit|nothing">
					            	<option tal:define="id_request request/departamento | python:''" 
											tal:attributes="value item/UID|nothing;
											selected python: str(item.UID) == str(id_request)"
											tal:content="item/Title|nothing">Marketing 
					                </option> 
				                </tal:cond>
				                <tal:cond condition="not: request/SearchSubmit|nothing">
					                <option tal:define="id_request request/departamento | python:''" 
											tal:attributes="value item/UID|nothing;
											selected python: uid_selected == item.UID"
											tal:content="item/Title|nothing">Marketing 
					                </option>
					           </tal:cond>
					            
				                
				            </tal:departamentos>	
						</select>
		            </tal:cond>
		            <tal:cond condition="python: filtro!='departamentos'">
		            	<select size="1" id="departamento" name="departamento" style="width:100%;">
							<option value="0" >Todos ...</option>	
							<tal:rep repeat="item view/list_filtro">
								<option tal:define="id_request request/departamento | python:'';
									 				itemDep python:item.__getattribute__(filtro)"
										tal:condition="itemDep"
										tal:attributes="value itemDep|nothing;
										selected python: str(id_request)==str(itemDep)"
										tal:content="itemDep|nothing">Marketing 
				               </option>
							   
							</tal:rep>
						</select>
					</tal:cond>
				</tal:def>
				<div class="aling-right"> 
					<input type="submit" name="SearchSubmit" value="Buscar" class="context" i18n:attributes="value"/>
				</div>
     	 	</form>
			
			<!-- Results -->
			<tal:results tal:define="quant view/get_quantidade_portlet;
									 results view/busca_usuarios;">
				<tal:cond condition="results">									 	
		    		<h4><strong i18n:translate="">Resultados</strong></h4>
			    	<div>
				    	<tal:results tal:define="busca python:results[:int(quant)];"
					  			   	  tal:repeat="item busca" >
								<div id="boxPortlet" tal:define="i repeat/item/end;"
	    					     					 tal:attributes="class python:view.getEnd(i);">
						     					 
                                    <!-- Dados para utilização da macro -->                                  
                                    <tal:def define="size_img string:50px;
                                                     principal_name python: view.get_principal_campo(item);
                                                     details python: view.get_details_user(item) or [];">
                                        <div metal:use-macro="context/myvindula-imageprofiles-macro/macros/userprofiles" />       
                                    </tal:def>    							

						 	</div>
						 	<div class="visualClear"></div>
			      		</tal:results>
					</div>
			    	<div class="titulo_info_boxTipo2 aling-right">
				        <h4 tal:condition="python:len(results)>int(quant)">
				        	<a tal:attributes="href  string:${here/portal_url}/myvindulalistall?campos=${view/form_dados}&departamento=${request/departamento|nothing}&filtro=${view/filtro_departamento|python:'departamentos'}&SearchSubmit=''">Mais...</a>

				        </h4>
				    </div>

				</tal:cond>
			</tal:results>
			<tal:notresults tal:condition="python: not view.busca_usuarios() and 'SearchSubmit' in context.REQUEST.form">
				<h4 tal:content="view/check_filter">N&atilde;o h&aacute; resultados.</h4>				
			</tal:notresults>
			<tal:cond condition="view/get_details_text|nothing">
				<br>
				<div class="titulo_info_boxTipo2 aling-right">
					<p tal:replace="structure view/get_details_text|nothing" />
				</div>
				
			</tal:cond>
			
		</div>
    </dd>
    <dd class="portletFooter"></dd>
</dl>
